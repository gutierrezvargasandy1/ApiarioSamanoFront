<div class="container">
        <!-- Panel Izquierdo - Lista de Almacenes -->
        <div class="left-panel">
            <div class="panel-header">
                <h2><span></span> Almacenes</h2>
                <button class="btn-nuevo-almacen" (click)="abrirModalAlmacen()">
                    <span>‚ûï</span> Nuevo
                </button>
            </div>
            
<div id="listaAlmacenes" class="almacenes-lista">
    <!-- Estado de carga -->
    <div *ngIf="cargando" class="loading-state">
        <div class="spinner"></div>
        <p>Cargando almacenes...</p>
    </div>

    <!-- Lista de almacenes -->
    <div *ngIf="!cargando && almacenes.length > 0">
        <div *ngFor="let almacen of almacenes" 
             class="almacen-item"
             [class.selected]="almacenSeleccionado?.id === almacen.id"
             (click)="seleccionarAlmacen(almacen)">
            
            <!-- Header del almac√©n -->
            <div class="almacen-header">
                <div class="almacen-info">
                    <h4 class="almacen-numero">Almac√©n #{{ almacen.numeroSeguimiento }}</h4>
                    <span class="almacen-ubicacion">üìç {{ almacen.ubicacion }}</span>
                </div>
                <div class="almacen-estado">
                    <span class="capacidad-badge">
                        {{ calcularEspaciosOcupados(almacen) }}/{{ almacen.capacidad }}
                    </span>
                    <div class="progress-bar">
                        <div class="progress-fill" 
                             [style.width.%]="calcularPorcentajeOcupacion(almacen)"
                             [class]="'nivel-' + obtenerClasePorcentaje(calcularPorcentajeOcupacion(almacen))">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contenido del almac√©n -->
            <div class="almacen-content">
                <div class="almacen-stats">
                    <div class="stat-item">
                        <span class="stat-icon">üì¶</span>
                        <span class="stat-value">{{ almacen.materiasPrimas?.length || 0 }}</span>
                        <span class="stat-label">Materias Primas</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">üõ†Ô∏è</span>
                        <span class="stat-value">{{ almacen.herramientas?.length || 0 }}</span>
                        <span class="stat-label">Herramientas</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">üíä</span>
                        <span class="stat-value">{{ almacen.medicamentos?.length || 0 }}</span>
                        <span class="stat-label">Medicamentos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">üìã</span>
                        <span class="stat-value">{{ lotesAlmacen?.length }}</span>
                        <span class="stat-label">Lotes</span>
                    </div>
                </div>

                <!-- Botones de acci√≥n -->
                <div class="almacen-actions">
                    <button class="btn btn-small btn-edit" 
                            (click)="abrirModalAlmacen(almacen); $event.stopPropagation()">
                        ‚úèÔ∏è Editar
                    </button>
                    <button class="btn btn-small btn-delete" 
                            (click)="eliminarAlmacen(almacen, $event)">
                        üóëÔ∏è Eliminar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Estado vac√≠o - FALTA ESTA PARTE -->
    <div *ngIf="!cargando && almacenes.length === 0" class="empty-state">
        <div class="empty-icon">üì¶</div>
        <h3>No hay almacenes registrados</h3>
        <p>Comienza creando tu primer almac√©n para organizar tus recursos</p>
        <button class="btn btn-primary" (click)="abrirModalAlmacen()">
            ‚ûï Crear Primer Almac√©n
        </button>
    </div>
</div>

</div>
        

 <!-- Panel Derecho - Detalles -->
<div class="right-panel">
    <div class="detalle-container">
        <div class="detalle-header">
            <h3 id="tituloDetalle">
                <span *ngIf="almacenSeleccionado">üì¶ {{ almacenSeleccionado.numeroSeguimiento }}</span>
                <span *ngIf="!almacenSeleccionado">üì¶ Selecciona un almac√©n</span>
            </h3>
        </div>

        <div id="contenidoDetalle">
            <!-- Estado vac√≠o cuando no hay almac√©n seleccionado -->
            <div *ngIf="!almacenSeleccionado" class="empty-state">
                <div class="empty-state-icon">üì¶</div>
                <p>Selecciona un almac√©n de la lista para ver sus detalles</p>
            </div>

            <!-- Detalles del almac√©n seleccionado -->
<!-- Detalles del almac√©n seleccionado -->
<div *ngIf="almacenSeleccionado" class="detalle-content">
    <!-- Informaci√≥n General -->
    <div class="detalle-section">
        <h4 class="section-title">üìã Informaci√≥n General</h4>
        <div class="info-grid">
            <div class="info-item">
                <label>N√∫mero de Seguimiento:</label>
                <span class="info-value">{{ almacenSeleccionado.numeroSeguimiento }}</span>
            </div>
            <div class="info-item">
                <label>Ubicaci√≥n:</label>
                <span class="info-value">üìç {{ almacenSeleccionado.ubicacion }}</span>
            </div>
            <div class="info-item">
                <label>Capacidad Total:</label>
                <span class="info-value">{{ almacenSeleccionado.capacidad }} unidades</span>
            </div>
            <div class="info-item">
                <label>Espacios Ocupados:</label>
                <span class="info-value">{{ calcularEspaciosOcupados(almacenSeleccionado) }} unidades</span>
            </div>
            <div class="info-item">
                <label>Porcentaje de Ocupaci√≥n:</label>
                <span class="info-value">
                    <span class="porcentaje-badge" 
                          [class]="'nivel-' + obtenerClasePorcentaje(calcularPorcentajeOcupacion(almacenSeleccionado))">
                        {{ calcularPorcentajeOcupacion(almacenSeleccionado) }}%
                    </span>
                </span>
            </div>
        </div>
    </div>

    <!-- Barra de progreso de capacidad -->
    <div class="capacidad-section">
        <div class="capacidad-header">
            <span>Capacidad del Almac√©n</span>
            <span class="capacidad-text">
                {{ calcularEspaciosOcupados(almacenSeleccionado) }}/{{ almacenSeleccionado.capacidad }}
            </span>
        </div>
        <div class="progress-bar large">
            <div class="progress-fill" 
                 [style.width.%]="calcularPorcentajeOcupacion(almacenSeleccionado)"
                 [class]="'nivel-' + obtenerClasePorcentaje(calcularPorcentajeOcupacion(almacenSeleccionado))">
            </div>
        </div>
    </div>

    <!-- Pesta√±as para los diferentes tipos de items -->
    <div class="tabs-section">
        <div class="tabs-header">
            <button class="tab-btn" 
                    [class.active]="tabActiva === 'materiasPrimas'"
                    (click)="cambiarTab('materiasPrimas')">
                üì¶ Materias Primas
                <span class="tab-badge">{{ almacenSeleccionado.materiasPrimas?.length || 0 }}</span>
            </button>
            <button class="tab-btn" 
                    [class.active]="tabActiva === 'herramientas'"
                    (click)="cambiarTab('herramientas')">
                üõ†Ô∏è Herramientas
                <span class="tab-badge">{{ almacenSeleccionado.herramientas?.length || 0 }}</span>
            </button>
            <button class="tab-btn" 
                    [class.active]="tabActiva === 'medicamentos'"
                    (click)="cambiarTab('medicamentos')">
                üíä Medicamentos
                <span class="tab-badge">{{ almacenSeleccionado.medicamentos?.length || 0 }}</span>
            </button>
            <!-- Nueva pesta√±a para Lotes -->
            <button class="tab-btn" 
                    [class.active]="tabActiva === 'lotes'"
                    (click)="cambiarTab('lotes')">
                üìã Lotes
                <span class="tab-badge">{{ lotesAlmacen?.length || 0 }}</span>
            </button>
        </div>

        <div class="tab-content">
            <!-- Bot√≥n para agregar nuevo item -->
            <div class="tab-actions">
                <button class="btn btn-primary btn-small" 
                        (click)="abrirModalItem()"
                        *ngIf="tabActiva !== 'lotes'">
                    ‚ûï Agregar {{ obtenerNombreTab() }}
                </button>
                <!-- Bot√≥n para agregar nuevo lote -->
                <button class="btn btn-primary btn-small" 
                        (click)="abrirModalLote()"
                        *ngIf="tabActiva === 'lotes'">
                    ‚ûï Agregar Lote
                </button>
            </div>

            <!-- Contenido de la pesta√±a activa -->
            <div *ngIf="tabActiva !== 'lotes' && obtenerItemsActuales().length > 0" class="items-grid">
                <div *ngFor="let item of obtenerItemsActuales()" 
                     class="item-card">
                    <div class="item-header">
                        <h5 class="item-name">{{ item.nombre }}</h5>
                        <div class="item-actions">
                            <button class="btn-icon btn-edit" 
                                    (click)="abrirModalItem(item); $event.stopPropagation()"
                                    title="Editar">
                                ‚úèÔ∏è
                            </button>
                            <button class="btn-icon btn-delete" 
                                    (click)="eliminarItem(item, $event)"
                                    title="Eliminar">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    
                    <div class="item-details">
                        <!-- Informaci√≥n espec√≠fica por tipo -->
                        <div *ngIf="tabActiva === 'materiasPrimas'" class="item-info">
                            <span class="item-stat">
                                <strong>Cantidad:</strong> {{ item.cantidad }}
                            </span>
                            <span class="item-stat" *ngIf="item.proveedor">
                                <strong>Proveedor:</strong> {{ item.proveedor.nombreEmpresa }}
                            </span>
                        </div>

                        <div *ngIf="tabActiva === 'herramientas'" class="item-info">
                            <span class="item-stat" *ngIf="item.proveedor">
                                <strong>Proveedor:</strong> {{ item.proveedor.nombreEmpresa }}
                            </span>
                        </div>

                        <div *ngIf="tabActiva === 'medicamentos'" class="item-info">
                            <span class="item-stat">
                                <strong>Cantidad:</strong> {{ item.cantidad }}
                            </span>
                            <span class="item-stat" *ngIf="item.descripcion">
                                <strong>Descripci√≥n:</strong> {{ item.descripcion }}
                            </span>
                            <span class="item-stat" *ngIf="item.proveedor">
                                <strong>Proveedor:</strong> {{ item.proveedor.nombreEmpresa }}
                            </span>
                        </div>

                        <!-- Foto si existe -->
                        <div *ngIf="item.foto" class="item-photo">
                            <img [src]="item.foto" [alt]="item.nombre" class="item-image">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contenido para la pesta√±a de Lotes -->
            <div *ngIf="tabActiva === 'lotes' && lotesAlmacen && lotesAlmacen.length > 0" class="items-grid">
                <div *ngFor="let lote of lotesAlmacen" 
                     class="item-card">
                    <div class="item-header">
                        <h5 class="item-name">{{ lote.numeroSeguimiento }}</h5>
                        <div class="item-actions">
                            <button class="btn-icon btn-edit" 
                                    (click)="abrirModalLote(lote); $event.stopPropagation()"
                                    title="Editar">
                                ‚úèÔ∏è
                            </button>
                            <button class="btn-icon btn-delete" 
                                    (click)="eliminarLote(lote, $event)"
                                    title="Eliminar">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    
                    <div class="item-details">
                        <div class="item-info">
                            <span class="item-stat">
                                <strong>Tipo de Producto:</strong> {{ lote.tipoProducto }}
                            </span>
                            <span class="item-stat">
                                <strong>Fecha de Creaci√≥n:</strong> {{ lote.fechaCreacion | date:'dd/MM/yyyy' }}
                            </span>
                            <span class="item-stat">
                                <strong>ID Almac√©n:</strong> {{ lote.idAlmacen }}
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Estado vac√≠o para la pesta√±a -->
            <div *ngIf="(tabActiva !== 'lotes' && obtenerItemsActuales().length === 0) || (tabActiva === 'lotes' && (!lotesAlmacen || lotesAlmacen.length === 0))" class="tab-empty-state">
                <div class="empty-icon">
                    <span *ngIf="tabActiva === 'materiasPrimas'">üì¶</span>
                    <span *ngIf="tabActiva === 'herramientas'">üõ†Ô∏è</span>
                    <span *ngIf="tabActiva === 'medicamentos'">üíä</span>
                    <span *ngIf="tabActiva === 'lotes'">üìã</span>
                </div>
                <h4>No hay {{ obtenerNombreTab() }}s registrados</h4>
                <p>Agrega tu primer {{ obtenerNombreTab().toLowerCase() }} para comenzar</p>
                <button class="btn btn-primary" 
        (click)="abrirModalItem()">
    ‚ûï Agregar {{ obtenerNombreTab() }}
</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para Lotes -->
<div class="modal-overlay" [class.active]="mostrarModalLote">
    <div class="modal">
        <div class="modal-header">
            <h3>{{ loteEditando ? 'Editar Lote' : 'Nuevo Lote' }}</h3>
            <button class="btn-close" (click)="cerrarModalLote()">&times;</button>
        </div>
        
        <div class="form-group">
            <label for="tipoProducto">Tipo de Producto *</label>
            <input type="text" 
                   id="tipoProducto" 
                   [(ngModel)]="formLote.tipoProducto" 
                   placeholder="Ingrese el tipo de producto">
        </div>

        <div class="form-group">
            <label for="idAlmacen">ID Almac√©n *</label>
            <input type="number" 
                   id="idAlmacen" 
                   [(ngModel)]="formLote.idAlmacen" 
                   [value]="almacenSeleccionado?.id"
                   [readonly]="true"
                   placeholder="ID del almac√©n">
            <small>Almac√©n actual: {{ almacenSeleccionado?.ubicacion }}</small>
        </div>

        <div class="modal-actions">
            <button class="btn-modal btn-cancelar" (click)="cerrarModalLote()">Cancelar</button>
            <button class="btn-modal btn-guardar" 
                    (click)="guardarLote()"
                    [disabled]="cargandoItems">
                {{ cargandoItems ? 'Guardando...' : 'Guardar' }}
            </button>
        </div>
    </div>
</div>
<!-- Modal para Medicamentos -->
<div class="modal-overlay" [class.active]="mostrarModalMedicamento">
    <div class="modal">
        <div class="modal-header">
            <h3>{{ medicamentoEditando ? 'Editar Medicamento' : 'Nuevo Medicamento' }}</h3>
            <button class="btn-close" (click)="cerrarModalMedicamento()">&times;</button>
        </div>
        
        <div class="form-group">
            <label for="medicamentoNombre">Nombre *</label>
            <input type="text" 
                   id="medicamentoNombre" 
                   [(ngModel)]="formMedicamento.nombre" 
                   placeholder="Ingrese el nombre del medicamento">
        </div>

        <div class="form-group">
            <label for="medicamentoDescripcion">Descripci√≥n</label>
            <textarea 
                id="medicamentoDescripcion" 
                [(ngModel)]="formMedicamento.descripcion" 
                placeholder="Descripci√≥n del medicamento"
                rows="3">
            </textarea>
        </div>

        <div class="form-group">
            <label for="medicamentoCantidad">Cantidad *</label>
            <input type="number" 
                   id="medicamentoCantidad" 
                   [(ngModel)]="formMedicamento.cantidad" 
                   placeholder="Cantidad disponible">
        </div>

        <div class="form-group">
            <label for="medicamentoProveedor">ID Proveedor *</label>
            <input type="number" 
                   id="medicamentoProveedor" 
                   [(ngModel)]="formMedicamento.idProveedor" 
                   placeholder="ID del proveedor">
        </div>

        <div class="modal-actions">
            <button class="btn-modal btn-cancelar" (click)="cerrarModalMedicamento()">Cancelar</button>
            <button class="btn-modal btn-guardar" 
                    (click)="guardarMedicamento()"
                    [disabled]="cargandoItems">
                {{ cargandoItems ? 'Guardando...' : 'Guardar' }}
            </button>
        </div>
    </div>
</div>

<!-- Modal para Herramientas -->
<div class="modal-overlay" [class.active]="mostrarModalHerramienta">
    <div class="modal">
        <div class="modal-header">
            <h3>{{ herramientaEditando ? 'Editar Herramienta' : 'Nueva Herramienta' }}</h3>
            <button class="btn-close" (click)="cerrarModalHerramienta()">&times;</button>
        </div>
        
        <div class="form-group">
            <label for="herramientaNombre">Nombre *</label>
            <input type="text" 
                   id="herramientaNombre" 
                   [(ngModel)]="formHerramienta.nombre" 
                   placeholder="Ingrese el nombre de la herramienta">
        </div>

        <div class="form-group">
            <label for="herramientaProveedor">ID Proveedor *</label>
            <input type="number" 
                   id="herramientaProveedor" 
                   [(ngModel)]="formHerramienta.idProveedor" 
                   placeholder="ID del proveedor">
        </div>

        <div class="modal-actions">
            <button class="btn-modal btn-cancelar" (click)="cerrarModalHerramienta()">Cancelar</button>
            <button class="btn-modal btn-guardar" 
                    (click)="guardarHerramienta()"
                    [disabled]="cargandoItems">
                {{ cargandoItems ? 'Guardando...' : 'Guardar' }}
            </button>
        </div>
    </div>
</div>

<!-- Modal para Materias Primas -->
<div class="modal-overlay" [class.active]="mostrarModalMateriaPrima">
    <div class="modal">
        <div class="modal-header">
            <h3>{{ materiaPrimaEditando ? 'Editar Materia Prima' : 'Nueva Materia Prima' }}</h3>
            <button class="btn-close" (click)="cerrarModalMateriaPrima()">&times;</button>
        </div>
        
        <div class="form-group">
            <label for="materiaPrimaNombre">Nombre *</label>
            <input type="text" 
                   id="materiaPrimaNombre" 
                   [(ngModel)]="formMateriaPrima.nombre" 
                   placeholder="Ingrese el nombre de la materia prima">
        </div>

        <div class="form-group">
            <label for="materiaPrimaCantidad">Cantidad *</label>
            <input type="number" 
                   id="materiaPrimaCantidad" 
                   [(ngModel)]="formMateriaPrima.cantidad" 
                   placeholder="Cantidad disponible">
        </div>

        <div class="form-group">
            <label for="materiaPrimaProveedor">ID Proveedor *</label>
            <input type="number" 
                   id="materiaPrimaProveedor" 
                   [(ngModel)]="formMateriaPrima.idProveedor" 
                   placeholder="ID del proveedor">
        </div>

        <div class="modal-actions">
            <button class="btn-modal btn-cancelar" (click)="cerrarModalMateriaPrima()">Cancelar</button>
            <button class="btn-modal btn-guardar" 
                    (click)="guardarMateriaPrima()"
                    [disabled]="cargandoItems">
                {{ cargandoItems ? 'Guardando...' : 'Guardar' }}
            </button>
        </div>
    </div>
</div>



        </div>
    </div>
</div>
    </div>

    <!-- Modal para Almac√©n -->
<div class="modal-overlay" [class.active]="mostrarModalAlmacen">
    <div class="modal">
        <div class="modal-header">
            <h3>{{ almacenEditando ? 'Editar Almac√©n' : 'Nuevo Almac√©n' }}</h3>
            <button class="btn-close" (click)="cerrarModalAlmacen()">√ó</button>
        </div>
        <form>
            <div class="form-group">
                <label>Ubicaci√≥n</label>
                <input 
                    type="text" 
                    [(ngModel)]="formAlmacen.ubicacion"
                    name="ubicacion"
                    required 
                    placeholder="Ej: Bodega Principal">
            </div>
            <div class="form-group">
                <label>Capacidad (unidades)</label>
                <input 
                    type="number" 
                    [(ngModel)]="formAlmacen.capacidad"
                    name="capacidad"
                    required 
                    placeholder="Ej: 1000">
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-modal btn-guardar" (click)="guardarAlmacen()">Guardar</button>
            </div>
        </form>
    </div>
</div>

    <!-- Modal para Items (Materias Primas, Herramientas, Medicamentos) -->
    <div class="modal-overlay" id="modalItem">
        <div class="modal">
            <div class="modal-header">
                <h3 id="tituloModalItem">Agregar Item</h3>
                <button class="btn-close" onclick="cerrarModalItem()">√ó</button>
            </div>
            <form id="formItem" onsubmit="guardarItem(event)">
                <div class="form-group">
                    <label>Nombre</label>
                    <input type="text" id="itemNombre" required placeholder="Nombre del item">
                </div>
                <div class="form-group">
                    <label>Cantidad</label>
                    <input type="number" id="itemCantidad" required placeholder="Cantidad disponible">
                </div>
                <div class="form-group">
                    <label>Precio Unitario</label>
                    <input type="number" step="0.01" id="itemPrecio" required placeholder="Precio por unidad">
                </div>
                <div class="form-group">
                    <label>Proveedor ID</label>
                    <input type="number" id="itemProveedor" required placeholder="ID del proveedor">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-modal btn-cancelar" onclick="cerrarModalItem()">Cancelar</button>
                    <button type="submit" class="btn-modal btn-guardar">Guardar</button>
                </div>
            </form>
        </div>
    </div>