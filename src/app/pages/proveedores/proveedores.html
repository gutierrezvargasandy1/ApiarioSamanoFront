<div class="proveedores-container">
  <!-- Header con t√≠tulo y acciones -->
  <div class="header">
    <h2>Gesti√≥n de Proveedores</h2>
    <div class="actions">
      <!-- B√∫squeda -->
      <div class="search-box">
        <input 
          type="text" 
          placeholder="Buscar proveedor..." 
          [(ngModel)]="terminoBusqueda" 
        />
        <span class="material-icons search-icon">search</span>
      </div>
      
      <!-- Bot√≥n nuevo proveedor -->
      <button class="btn add" (click)="abrirFormulario()">
        <span class="material-icons">person_add</span> 
        Nuevo Proveedor
      </button>
    </div>
  </div>

  <!-- Tabla de proveedores -->
  <div class="tabla-container">
    <table class="tabla">
      <thead>
        <tr>
          <th>Fotograf√≠a</th>
          <th>Nombre Empresa</th>
          <th>Tel√©fono</th>
          <th>Material que Provee</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <!-- Lista de proveedores -->
        <tr *ngFor="let proveedor of filtrarProveedores()" class="fade-in">
          <td>
            <!-- Imagen del proveedor -->
            <img 
              *ngIf="proveedor.fotografia" 
              [src]="getFotoUrl(proveedor.fotografia)" 
              alt="Foto de {{ proveedor.nombreEmpresa }}" 
            />
            <!-- Placeholder si no hay imagen -->
            <div *ngIf="!proveedor.fotografia" class="no-imagen">
              üè¢
            </div>
          </td>
          <td><strong>{{ proveedor.nombreEmpresa }}</strong></td>
          <td>{{ proveedor.numTelefono }}</td>
          <td>{{ proveedor.materialProvee }}</td>
          <td>
            <div class="tabla-acciones">
              <!-- Bot√≥n editar -->
              <button 
                class="btn edit" 
                (click)="editarProveedor(proveedor)"
                title="Editar proveedor"
              >
                <span class="material-icons">edit</span>
              </button>
              
              <!-- Bot√≥n eliminar -->
              <button 
                class="btn delete" 
                (click)="eliminarProveedor(proveedor)"
                title="Eliminar proveedor"
              >
                <span class="material-icons">delete</span>
              </button>
            </div>
          </td>
        </tr>

        <!-- Estado vac√≠o cuando no hay proveedores -->
        <tr *ngIf="filtrarProveedores().length === 0">
          <td colspan="5">
            <div class="empty-state">
              <div class="empty-state-icon">üì¶</div>
              <h3>No hay proveedores registrados</h3>
              <p>Comienza agregando tu primer proveedor</p>
              <button class="btn add" (click)="abrirFormulario()">
                <span class="material-icons">person_add</span>
                Agregar Primer Proveedor
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal para agregar/editar proveedor -->
  <div class="modal" *ngIf="mostrarFormulario">
    <div class="modal-content">
      <h3>{{ editando ? 'Editar Proveedor' : 'Nuevo Proveedor' }}</h3>

      <form (ngSubmit)="guardarProveedor()">
        <!-- Nombre de la empresa -->
        <div>
          <label for="nombreEmpresa">Nombre de la Empresa *</label>
          <input 
            type="text" 
            id="nombreEmpresa"
            [(ngModel)]="proveedorSeleccionado.nombreEmpresa" 
            name="nombre_empresa" 
            placeholder="Ej: Maderas y Materiales S.A."
            required 
          />
        </div>

        <!-- Tel√©fono -->
        <div>
          <label for="telefono">N√∫mero de Tel√©fono *</label>
          <input 
            type="tel" 
            id="telefono"
            [(ngModel)]="proveedorSeleccionado.numTelefono" 
            name="telefono" 
            placeholder="Ej: 461-123-4567"
            required 
          />
        </div>

        <!-- Material que provee -->
        <div>
          <label for="material">Material que Provee *</label>
          <input 
            type="text" 
            id="material"
            [(ngModel)]="proveedorSeleccionado.materialProvee" 
            name="material" 
            placeholder="Ej: Madera, Cemento, Herramientas"
            required 
          />
        </div>

        <!-- Fotograf√≠a -->
        <div>
          <label>Fotograf√≠a de la Empresa</label>
          
          <!-- Mostrar bot√≥n de selecci√≥n solo si NO hay imagen -->
          <div class="file-input-container" *ngIf="!proveedorSeleccionado.fotografia">
            <input 
              type="file" 
              id="foto"
              (change)="onFileSelected($event)" 
              accept="image/*"
            />
            <label for="foto" class="file-input-label">
              <span class="material-icons">add_photo_alternate</span>
              Seleccionar Imagen
            </label>
          </div>

          <!-- Preview de la imagen -->
          <div 
            class="image-preview" 
            *ngIf="proveedorSeleccionado.fotografia"
          >
            <img 
              [src]="proveedorSeleccionado.fotografia" 
              alt="Preview" 
            />
            <button 
              type="button" 
              class="remove-image" 
              (click)="eliminarFoto()"
              title="Eliminar foto"
            >
              <span class="material-icons">close</span>
            </button>
          </div>
        </div>

        <!-- Acciones del modal -->
        <div class="modal-actions">
          <button class="btn save" type="submit">
            <span class="material-icons">check</span> 
            Guardar
          </button>
          <button 
            class="btn cancel" 
            type="button" 
            (click)="cerrarFormulario()"
          >
            <span class="material-icons">close</span> 
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>